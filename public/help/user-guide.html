<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Auction Software User Guide</title>
  


<style>
.collapsible-section.collapsed {
  display: none;
}
h1 {
  user-select: none;

}
h1::after {
  content: " ‚ñº";
  font-size: 0.7em;
  color: #666;
}
.collapsible-section.collapsed + h1::after {
  content: " ‚ñ∂";
}
img.placeholder {
  display: block;
  margin: 1em auto;
  max-width: 100%;
  border: 1px dashed #ccc;
  padding: 10px;
}


    body { font-family: Arial, sans-serif; max-width: 800px; margin: 2em auto; padding: 1em; line-height: 1.6; }
        h1 { color: #da931a; }
    h2 { color: #003366; }
    ul { margin-left: 1.2em; }
    code { background: #f0f0f0; padding: 2px 5px; border-radius: 4px; }
    .section { margin-bottom: 2em; }

  
    .function-matrix {
      width: 100%;
      border-collapse: collapse;
      font-family: Arial, sans-serif;
      margin: 2em 0;
    }

    .function-matrix th,
    .function-matrix td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: center;
      vertical-align: middle;
    }

    .function-matrix th {
      background-color: #003366;
      color: white;
    }

    .function-matrix tr:nth-child(even) {
      background-color: #f9f9f9;
    }

    .function-matrix tr:hover {
      background-color: #f1f1f1;
    }

    .function-matrix td {
      font-size: 0.95em;
    }

    .function-matrix .tick-yes {
      color: green;
      font-weight: bold;
    }

    .function-matrix .tick-no {
      color: red;
      font-weight: bold;
    }

    .function-matrix .tick-conditional {
      color: #d4a600;
      font-weight: bold;
      text-align: left;
    }
  

</style>


<script>
document.addEventListener("DOMContentLoaded", () => {
  const headers = document.querySelectorAll("h1");

  // Get ?section=... param from URL
  const urlParams = new URLSearchParams(window.location.search);
  const sectionToOpen = urlParams.get("section");

  headers.forEach(h1 => {
    const section = document.createElement("div");
    section.classList.add("collapsible-section", "collapsed");

    let next = h1.nextElementSibling;
    const elements = [];
    while (next && next.tagName !== "H1") {
      elements.push(next);
      next = next.nextElementSibling;
    }

    elements.forEach(el => section.appendChild(el));
    h1.insertAdjacentElement("afterend", section);

    h1.style.cursor = "pointer";
    h1.addEventListener("click", () => {
      section.classList.toggle("collapsed");
    });

    const slug = h1.textContent.toLowerCase().replace(/[^a-z0-9]+/g, "-").replace(/(^-|-$)/g, "");
    h1.id = slug;

    if (slug === sectionToOpen) {
      section.classList.remove("collapsed");
    }
  });
});
</script>

</head>
<body>

  <h1>Function / state quick reference</h1>

<table border="1" class="dataframe function-matrix">
  <thead>
    <tr style="text-align: right;">
      <th>Function</th>
      <th>User</th>
      <th>Setup</th>
      <th>Locked</th>
      <th>Live</th>
      <th>Settlement</th>
      <th>Archive</th>
    </tr>
  </thead>
  <tbody>

    <tr>
      <td>Submit item (public)</td>
      <td></td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
    </tr>
    <tr>
      <td>Add new item</td>
      <td>A</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
    </tr>
    <tr>
      <td>Edit item</td>
      <td>A</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
    </tr>
    <tr>
      <td>Move (within auction)</td>
      <td>A</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
    </tr>
    <tr>
      <td>Move (to auction)</td>
      <td>A</td>
      <td class="tick-conditional">üü° target ‚Äúsetup‚Äù or ‚Äúlocked‚Äù</td>
      <td class="tick-conditional">üü° target ‚Äúsetup‚Äù or ‚Äúlocked‚Äù</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
    </tr>
    <tr>
      <td>Rotate photo</td>
      <td>A</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
    </tr>
    <tr>
      <td>Crop photo</td>
      <td>A</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
    </tr>
    <tr>
      <td>Delete item</td>
      <td>A</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
    </tr>
    <tr>
      <td>Record bid</td>
      <td>A</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-no">‚ùå</td>
    </tr>
    <tr>
      <td>Undo bid</td>
      <td>A</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-conditional">üü° If bidder not paid</td>
      <td class="tick-no">‚ùå</td>
    </tr>
    <tr>
      <td>View payments</td>
      <td>C</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-yes">‚úÖ</td>
    </tr>
    <tr>
      <td>Take payments</td>
      <td>C</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-no">‚ùå</td>
    </tr>
    <tr>
      <td>Undo payments</td>
      <td>C</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-no">‚ùå</td>
    </tr>
    <tr>
      <td>Run slideshow</td>
      <td>A</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-yes">‚úÖ</td>
    </tr>
    <tr>
      <td>Show live bidding view</td>
      <td>A,C</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-yes">‚úÖ</td>
    </tr>
    <tr>
      <td>Add test items</td>
      <td>M</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
    </tr>
    <tr>
      <td>Add test bids</td>
      <td>M</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
    </tr>
    <tr>
      <td>Reset auction</td>
      <td>M</td>
      <td class="tick-yes">‚úÖ</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-yes">‚úÖ</td>
    </tr>
    <tr>
      <td>Delete auction</td>
      <td>M</td>
      <td class="tick-conditional">üü° When no items</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-no">‚ùå</td>
      <td class="tick-conditional">üü° When no items</td>
    </tr>
  </tbody>
</table>



  <h1>Admin Panel</h1>

  <div class="section">
    <h2>Overview</h2>
    <p>The Admin interface provides tools for managing auction items: submitting, editing, organizing, and exporting data for presentation and reporting.</p>
  </div>

  <div class="section">
    <h2>Functional Areas</h2>

    <h3>Auction Tools</h3>
    <ul>
      <li><strong>Auction Selector:</strong> Choose which auction you're working in. The state is also shown</li>
      <li><strong>Sorting Options:</strong> Sort the item list by item number, description, contributor, creator, bidder, or price, in ascending or descending order.</li>
      <li><strong>Item counts and Value:</strong> Shows a live count of bids and the current total.</li>
    </ul>

    <h3>Item Management</h3>
    <p>The controls available will depend on the auction state (and for moves, the state of the target auction)</p>
    <ul>
      <li><strong>Create New Item:</strong> Opens the item form to enter a new submission with optional photo and notes.</li>
      <li><strong>Edit:</strong> Opens the edit form to modify the selected item.</li>
      <li><strong>Photo Tools:</strong> Rotate, crop, or replace an image.</li>
      <li><strong>Delete:</strong> Remove the item and its photos permanently.</li>
      <li><strong>Move within auction:</strong> Move the item within the auction</li>
      <li><strong>Move to auction:</strong> Move the item to a different auction. The item will be placed at the end of the target auction</li>
      <li><strong>Finalise:</strong> Record the bidder and hammer price for the item. When the bid is recorded, focus will automatically shift to the next un-finalised item in the table/li>
      <li><strong>Undo bid:</strong> Undo a recorded bid.</li>
      <li><strong>History:</strong> Displays a detailed log of changes for a specific item, including timestamp, user, and action type.</li>
    </ul>


    <h3>Export Options</h3>
    <ul>
      <li><strong>Generate CSV Export:</strong> Download all items in spreadsheet format.</li>
      <li><strong>Generate Auction Slides:</strong> Create a PowerPoint deck with one slide per item, styled according to the current template configuration.</li>
      <li><strong>Generate Item Cards:</strong> Produces A6-sized slides/cards for printing and on-site use.</li>
    </ul>

    <h3>Navigation</h3>
    <ul>
      <li><strong>Public Form:</strong> Opens the public-facing item submission page.</li>
      <li><strong>Live Feed:</strong> Opens the auction live bid display.</li>
      <li><strong>Maintenance:</strong> Opens the maintenance panel (separate login required).</li>
      <li><strong>Cashier:</strong> Opens the cashier interface (separate login required).</li>
      <li><strong>Slideshow:</strong> Opens the presentation slideshow mode (will end your current admin session).</li>
    </ul>

    <h3>Session</h3>
    <ul>
      <li><strong>Logout:</strong> Ends your current admin session and returns you to the login screen.</li>
    </ul>
  </div>

  

    <h1>Cashier Panel</h1>

  <div class="section">
    <h2>Overview</h2>
    <p>This interface supports closing out payments after the auction. It shows what each bidder owes and tracks payments</p>
  <p>Select an auction from the dropdown and then select to open Live View or Manage Payments</p>
  </div>

  <div class="section">
    <h2>Manage Payments</h2>

    <h3>Bidder List (Left Panel)</h3>
    <ul>
      <li>Lists all bidders who have won items.</li>
      <li>Each row shows the paddle number and total amount due.</li>
      <li>Click a row to view details and process payments.</li>
      <li><strong>Green highlight</strong> indicates a bidder is fully settled.</li>
      <li><strong>Download CSV:</strong> Exports bidder payment status summary.</li>
    </ul>

    <h3>Bidder Details (Right Panel)</h3>
    <ul>
      <li><strong>Lots Won:</strong> Displays all winning bids and their prices.</li>
      <li><strong>Payments:</strong> Shows recorded payment transactions.</li>
      <li><strong>Totals:</strong> Calculates outstanding balance in real time.</li>
    </ul>

    <h3>Payment Buttons</h3>
    <ul>
      <li>Options: <strong>Cash</strong>, <strong>Card (manual)</strong>, <strong>PayPal (manual)</strong></li>
      <li>Clicking a button opens a popup to enter amount and optional note.</li>
      <li>All payments are timestamped and listed immediately.</li>
    </ul>
  </div>

  <h2>Live Feed</h2>
  <p>
    The Live Feed interface displays a real-time view of auction activity. It shows bidding outcomes as they are finalised
  </p>

  <h3>Features</h3>
  <ul>
    <li><strong>Lot Data:</strong> For each sold item, the paddle number, lot number, item title, and hammer price are shown.</li>
    <li><strong>Connection Status:</strong> An indicator displays whether the feed is actively receiving updates (<span style="color:green;">green</span>) or stale (<span style="color:darkorange;">orange</span>).</li>
    <li><strong>Filter by Paddle:</strong> Enter a paddle number and press <strong>Go</strong> to view only that bidder‚Äôs wins.</li>
    <li><strong>Show Unsold:</strong> Toggle whether items with no recorded bid are shown in the list.</li>
    <li><strong>Live Updates:</strong> The page listens for changes without needing manual refreshes.</li>
  </ul>


  <h1>Slideshow</h1>

  <div class="section">
    <h2>Overview</h2>
    <p>This slideshow is designed for unattended display during the live auction. It cycles through item images with optional text overlays and supports remote updates from the admin panel.</p>
  </div>

  <div class="section">
    <h2>Getting Started</h2>
    <ul>
      <li>On first load, you'll be prompted to enter the <strong>auction short name</strong> and <strong>admin password</strong>.</li>
      <li>Once validated, the system enters full-screen slideshow mode and logs out any existing elevated user sessions for security.</li>
    </ul>
  </div>

  <div class="section">
    <h2>Controls & Shortcuts</h2>
    <ul>
      <li><strong>[c]</strong> ‚Äì Toggle configuration panel</li>
      <li><strong>[space]</strong> ‚Äì Pause or resume the slideshow</li>
      <li><strong>[Esc]</strong> ‚Äì Pause slideshow</li>
      <li><strong>Tap-and-hold</strong> or <strong>click-and-hold</strong> ‚Äì Show configuration panel on touch screens</li>
    </ul>
  </div>

  <div class="section">
    <h2>Configuration Panel</h2>
    <p>This overlay appears when triggered by keyboard or touch. It auto-hides after 10 seconds of inactivity.</p>
    <ul>
      <li><strong>Transition Time:</strong> Duration each slide is shown (in seconds)</li>
      <li><strong>Show Description:</strong> Toggle display of item description</li>
      <li><strong>Show Contributor:</strong> Toggle display of the item's donor</li>
      <li><strong>Show Creator:</strong> Toggle display of the artist/creator</li>
      <li><strong>Refresh Interval:</strong> How often to check for new items (in seconds)</li>
      <li><strong>Shuffle Items:</strong> Enable randomized item order</li>
      <li><strong>Change Auction / Logout:</strong> Reset slideshow and prompt for new auction details</li>
      <li><strong>Pause / Resume / Reload:</strong> Playback controls</li>
    </ul>
  </div>

  <div class="section">
    <h2>How It Works</h2>
    <ul>
      <li>Items are loaded dynamically from the server, but only if a photo is present for the item.</li>
      <li>Items are shuffled (if enabled) and loop continuously. Once the queue is exhausted, it restarts.</li>
      <li>The slideshow polls the backend regularly to fetch new items and updates in real-time.</li>
    </ul>
  </div>

 <h1>Maintenance Panel</h1>

  <div class="section">
    <h2>Overview</h2>
    <p>This interface provides access to tools for managing auctions, data management, configuring export templates, and other tasks.</p>
  </div>

  <div class="section">
    <h2>Functional Areas</h2>

    <h3>Auction Management</h3>
    <ul>
      <li><strong>Create New Auction:</strong> Define a full display name and a short URL tag (e.g. <code>?auction=fof2026</code>).</li>
      <li><strong>Select Logo:</strong> Choose a logo from the uploaded image set for branding & PowerPoint slides.</li>
      <li><strong>Existing Auctions Table:</strong> Lists all auctions, showing ID, name, tag, logo, item count, and status. 
        Actions include: Setting auction status, Delete (if empty), Reset: Remove all items. Deleting the last auction will delete the audit history and reset all counters in the database</li>
    </ul>

    <h3>Database</h3>
    <ul>
      <li><strong>Create Backup on Server:</strong> Makes a snapshot of the current database to a folder on the server.</li>
      <li><strong>Restore Database:</strong> Upload a previously saved databse file.</li>
    </ul>

    <h3>Import/Export</h3>
    <ul>
      <li><strong>Export CSV:</strong> Exports all items in CSV format.</li>
      <li><strong>Import CSV:</strong> Bulk import items using a CSV. Required column headers: <code>description</code>, <code>artist</code>, <code>contributor</code>, <code>notes</code>, and <code>auction_id</code>.</li>
      <li><strong>Download Database and Photos:</strong> Exports a zipped copy of the database and all photos.</li>
    </ul>

    <h3>Diagnostics</h3>
    <ul>
      <li><strong>Photo Storage Report:</strong> Shows number and total size of stored images.</li>
      <li><strong>Check for Invalid Items:</strong> Identifies broken item entries (e.g. missing auctions or photos).</li>
      <li><strong>Delete Invalid Items:</strong> Permanently removes broken entries.</li>
      <li><strong>Clean Up Unused Photos:</strong> Finds and deletes orphaned photo files.</li>
      <li><strong>Restart Server:</strong> Sends a soft restart command to the backend process. Requires that pm2 is used with the process name "auction"</li>
    </ul>

    <h3>Security</h3>
    <ul>
      <li><strong>Change Password:</strong> Update password for Admin, Cashier, or Maintenance roles.</li>
    </ul>

    <h3>Generate Test Data</h3>
    <ul>
      <li><strong>Generate Items:</strong> Add a number of mock items to a selected auction for testing purposes.</li>
      <li><strong>Generate Test Bids:</strong> Simulate activity by generating test bids and bidders.</li>
      <li><strong>Delete Test Bids:</strong> Clears all test bidding data.</li>
    </ul>

    <h3>PowerPoint Template Editor</h3>
    <ul>
      <li><strong>Edit Config:</strong> Select between <code>Slide Config</code> or <code>Card Config</code> to modify PowerPoint layout settings in JSON format.</li>
      <li><strong>Reset to Default:</strong> Revert selected config to factory settings.</li>
    </ul>

    <h3>Image Manager</h3>
    <ul>
      <li><strong>Upload Images:</strong> Upload assets (e.g. logos or backgrounds) for use in PowerPoint and/or auction logos.</li>
      <li><strong>Delete:</strong> Remove previously uploaded image resources.</li>
    </ul>

    <h3>Audit Log Viewer</h3>
    <ul>
      <li><strong>Fetch Audit Log:</strong> Loads audit history showing time, user, action, item details, and auction.</li>
      <li><strong>Filter by Item ID:</strong> Narrow the log view to actions affecting a specific item. Note that this is a unique database internal item ID. </li>
      <li><strong>Download CSV:</strong> Export log data for offline review or archiving.</li>
    </ul>

    <h3>Server Logs</h3>
    <ul>
      <li><strong>View Logs:</strong> Show recent backend server output.</li>
      <li><strong>Auto-Refresh:</strong> Enable live updates every 5 seconds.</li>
    </ul>
  </div>

</body>
</html>
